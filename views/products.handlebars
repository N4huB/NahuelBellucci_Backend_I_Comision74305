<div class="container">
    <h1>Productos</h1>
    
    <!-- Filtros y ordenamiento -->
    <div class="filters">
        <form method="GET">
            <input type="text" name="query" placeholder="Buscar por categoría o 'available'" value="{{query.query}}">
            <select name="sort">
                <option value="">Sin orden</option>
                <option value="asc" {{#if (eq query.sort 'asc')}}selected{{/if}}>Precio: menor a mayor</option>
                <option value="desc" {{#if (eq query.sort 'desc')}}selected{{/if}}>Precio: mayor a menor</option>
            </select>
            <select name="limit">
                <option value="5" {{#if (eq query.limit '5')}}selected{{/if}}>5 por página</option>
                <option value="10" {{#if (eq query.limit '10')}}selected{{/if}}>10 por página</option>
                <option value="20" {{#if (eq query.limit '20')}}selected{{/if}}>20 por página</option>
            </select>
            <button type="submit">Filtrar</button>
        </form>
    </div>

    <!-- Lista de productos -->
    <div class="products-grid">
        {{#each products}}
        <div class="product-card">
            <h3>{{title}}</h3>
            <p>{{description}}</p>
            <p><strong>Precio:</strong> ${{price}}</p>
            <p><strong>Stock:</strong> {{stock}}</p>
            <p><strong>Categoría:</strong> {{category}}</p>
            <p><strong>Estado:</strong> {{#if status}}Disponible{{else}}No disponible{{/if}}</p>
            <button onclick="addToCart('{{_id}}')">Agregar al carrito</button>
        </div>
        {{/each}}
    </div>

    <!-- Paginación -->
    <div class="pagination">
        {{#if pagination.hasPrevPage}}
            <a href="{{pagination.prevLink}}">← Anterior</a>
        {{/if}}
        
        <span>Página {{pagination.page}} de {{pagination.totalPages}}</span>
        
        {{#if pagination.hasNextPage}}
            <a href="{{pagination.nextLink}}">Siguiente →</a>
        {{/if}}
    </div>
</div>

<script>
function addToCart(productId) {
    // Aquí podrías implementar la lógica para agregar al carrito
    // Por ejemplo, hacer un POST a /api/carts/:cid/product/:pid
    alert('Producto agregado al carrito: ' + productId);
}
</script>

<style>
.container { max-width: 1200px; margin: 0 auto; padding: 20px; }
.filters { margin-bottom: 20px; padding: 15px; background: #f5f5f5; border-radius: 5px; }
.filters form { display: flex; gap: 10px; align-items: center; }
.filters input, .filters select, .filters button { padding: 8px; border: 1px solid #ddd; border-radius: 3px; }
.products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
.product-card { border: 1px solid #ddd; padding: 15px; border-radius: 5px; background: white; }
.product-card h3 { margin-top: 0; color: #333; }
.product-card button { background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 3px; cursor: pointer; }
.product-card button:hover { background: #0056b3; }
.pagination { text-align: center; }
.pagination a { display: inline-block; padding: 8px 16px; margin: 0 5px; background: #007bff; color: white; text-decoration: none; border-radius: 3px; }
.pagination a:hover { background: #0056b3; }
.pagination span { margin: 0 15px; font-weight: bold; }
</style>